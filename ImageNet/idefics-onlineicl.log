nohup: ignoring input
/home/chy63/.conda/envs/openflamingo/lib/python3.9/site-packages/torchvision/datapoints/__init__.py:12: UserWarning: The torchvision.datapoints and torchvision.transforms.v2 namespaces are still Beta. While we do not expect major breaking changes, some APIs may still change according to user feedback. Please submit any feedback you may have in this issue: https://github.com/pytorch/vision/issues/6753, and you can also check out https://github.com/pytorch/vision/issues/7319 to learn more about the APIs that we suspect might involve future changes. You can silence this warning by calling torchvision.disable_beta_transforms_warning().
  warnings.warn(_BETA_TRANSFORMS_WARNING)
/home/chy63/.conda/envs/openflamingo/lib/python3.9/site-packages/torchvision/transforms/v2/__init__.py:54: UserWarning: The torchvision.datapoints and torchvision.transforms.v2 namespaces are still Beta. While we do not expect major breaking changes, some APIs may still change according to user feedback. Please submit any feedback you may have in this issue: https://github.com/pytorch/vision/issues/6753, and you can also check out https://github.com/pytorch/vision/issues/7319 to learn more about the APIs that we suspect might involve future changes. You can silence this warning by calling torchvision.disable_beta_transforms_warning().
  warnings.warn(_BETA_TRANSFORMS_WARNING)
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:06,  1.01s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:01<00:04,  1.02it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:02<00:03,  1.04it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:04<00:01,  1.06it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:05<00:00,  1.09it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.09it/s]
load clip successfully...
Loaded class indices from ./imagenet_class_indices.pkl
self.args.catergory_num:100
len of self.all_class_names:100
get memory bank and sample pool ...
get samples for each class:   0%|          | 0/100 [00:00<?, ?it/s]get samples for each class:   1%|          | 1/100 [00:00<00:35,  2.80it/s]get samples for each class:   2%|▏         | 2/100 [00:00<00:34,  2.86it/s]get samples for each class:   3%|▎         | 3/100 [00:00<00:29,  3.24it/s]get samples for each class:   4%|▍         | 4/100 [00:01<00:27,  3.45it/s]get samples for each class:   5%|▌         | 5/100 [00:01<00:29,  3.26it/s]get samples for each class:   6%|▌         | 6/100 [00:01<00:30,  3.10it/s]get samples for each class:   7%|▋         | 7/100 [00:02<00:32,  2.89it/s]get samples for each class:   8%|▊         | 8/100 [00:02<00:33,  2.75it/s]get samples for each class:   9%|▉         | 9/100 [00:03<00:33,  2.73it/s]get samples for each class:  10%|█         | 10/100 [00:03<00:33,  2.67it/s]get samples for each class:  11%|█         | 11/100 [00:03<00:31,  2.85it/s]get samples for each class:  12%|█▏        | 12/100 [00:04<00:29,  3.01it/s]get samples for each class:  13%|█▎        | 13/100 [00:04<00:28,  3.10it/s]get samples for each class:  14%|█▍        | 14/100 [00:04<00:27,  3.14it/s]get samples for each class:  15%|█▌        | 15/100 [00:04<00:27,  3.13it/s]get samples for each class:  16%|█▌        | 16/100 [00:05<00:26,  3.12it/s]get samples for each class:  17%|█▋        | 17/100 [00:05<00:25,  3.22it/s]get samples for each class:  18%|█▊        | 18/100 [00:05<00:25,  3.16it/s]get samples for each class:  19%|█▉        | 19/100 [00:06<00:26,  3.10it/s]get samples for each class:  20%|██        | 20/100 [00:06<00:25,  3.17it/s]get samples for each class:  21%|██        | 21/100 [00:06<00:24,  3.20it/s]get samples for each class:  22%|██▏       | 22/100 [00:07<00:23,  3.29it/s]get samples for each class:  23%|██▎       | 23/100 [00:07<00:23,  3.28it/s]get samples for each class:  24%|██▍       | 24/100 [00:07<00:23,  3.21it/s]get samples for each class:  25%|██▌       | 25/100 [00:08<00:23,  3.15it/s]get samples for each class:  26%|██▌       | 26/100 [00:08<00:23,  3.09it/s]get samples for each class:  27%|██▋       | 27/100 [00:08<00:22,  3.24it/s]get samples for each class:  28%|██▊       | 28/100 [00:09<00:22,  3.17it/s]get samples for each class:  29%|██▉       | 29/100 [00:09<00:21,  3.26it/s]get samples for each class:  30%|███       | 30/100 [00:09<00:19,  3.63it/s]get samples for each class:  31%|███       | 31/100 [00:09<00:20,  3.32it/s]get samples for each class:  32%|███▏      | 32/100 [00:10<00:21,  3.16it/s]get samples for each class:  33%|███▎      | 33/100 [00:10<00:22,  3.04it/s]get samples for each class:  34%|███▍      | 34/100 [00:10<00:21,  3.10it/s]get samples for each class:  35%|███▌      | 35/100 [00:11<00:21,  3.06it/s]get samples for each class:  36%|███▌      | 36/100 [00:11<00:22,  2.91it/s]get samples for each class:  37%|███▋      | 37/100 [00:11<00:21,  2.96it/s]get samples for each class:  38%|███▊      | 38/100 [00:12<00:27,  2.29it/s]get samples for each class:  39%|███▉      | 39/100 [00:12<00:23,  2.56it/s]get samples for each class:  40%|████      | 40/100 [00:13<00:23,  2.59it/s]get samples for each class:  41%|████      | 41/100 [00:13<00:21,  2.72it/s]get samples for each class:  42%|████▏     | 42/100 [00:13<00:20,  2.86it/s]get samples for each class:  43%|████▎     | 43/100 [00:14<00:19,  2.93it/s]get samples for each class:  44%|████▍     | 44/100 [00:14<00:17,  3.17it/s]get samples for each class:  45%|████▌     | 45/100 [00:14<00:17,  3.15it/s]get samples for each class:  46%|████▌     | 46/100 [00:15<00:17,  3.06it/s]get samples for each class:  47%|████▋     | 47/100 [00:15<00:17,  3.07it/s]get samples for each class:  48%|████▊     | 48/100 [00:15<00:16,  3.20it/s]get samples for each class:  49%|████▉     | 49/100 [00:16<00:16,  3.05it/s]get samples for each class:  50%|█████     | 50/100 [00:16<00:17,  2.86it/s]get samples for each class:  51%|█████     | 51/100 [00:16<00:17,  2.79it/s]get samples for each class:  52%|█████▏    | 52/100 [00:17<00:16,  2.98it/s]get samples for each class:  53%|█████▎    | 53/100 [00:17<00:16,  2.91it/s]get samples for each class:  54%|█████▍    | 54/100 [00:18<00:17,  2.60it/s]get samples for each class:  55%|█████▌    | 55/100 [00:18<00:17,  2.57it/s]get samples for each class:  56%|█████▌    | 56/100 [00:18<00:16,  2.63it/s]get samples for each class:  57%|█████▋    | 57/100 [00:19<00:15,  2.74it/s]get samples for each class:  58%|█████▊    | 58/100 [00:19<00:16,  2.62it/s]get samples for each class:  59%|█████▉    | 59/100 [00:19<00:15,  2.62it/s]get samples for each class:  60%|██████    | 60/100 [00:20<00:13,  2.97it/s]get samples for each class:  61%|██████    | 61/100 [00:20<00:12,  3.05it/s]get samples for each class:  62%|██████▏   | 62/100 [00:20<00:13,  2.90it/s]get samples for each class:  63%|██████▎   | 63/100 [00:21<00:13,  2.83it/s]get samples for each class:  64%|██████▍   | 64/100 [00:21<00:11,  3.12it/s]get samples for each class:  65%|██████▌   | 65/100 [00:22<00:13,  2.60it/s]get samples for each class:  66%|██████▌   | 66/100 [00:22<00:12,  2.76it/s]get samples for each class:  67%|██████▋   | 67/100 [00:22<00:11,  2.95it/s]get samples for each class:  68%|██████▊   | 68/100 [00:22<00:11,  2.83it/s]get samples for each class:  69%|██████▉   | 69/100 [00:23<00:10,  3.06it/s]get samples for each class:  70%|███████   | 70/100 [00:23<00:10,  2.99it/s]get samples for each class:  71%|███████   | 71/100 [00:23<00:09,  3.03it/s]get samples for each class:  72%|███████▏  | 72/100 [00:24<00:09,  3.07it/s]get samples for each class:  73%|███████▎  | 73/100 [00:24<00:08,  3.12it/s]get samples for each class:  74%|███████▍  | 74/100 [00:24<00:07,  3.35it/s]get samples for each class:  75%|███████▌  | 75/100 [00:25<00:07,  3.21it/s]get samples for each class:  76%|███████▌  | 76/100 [00:25<00:07,  3.29it/s]get samples for each class:  77%|███████▋  | 77/100 [00:25<00:07,  3.15it/s]get samples for each class:  78%|███████▊  | 78/100 [00:26<00:06,  3.17it/s]get samples for each class:  79%|███████▉  | 79/100 [00:26<00:06,  3.49it/s]get samples for each class:  80%|████████  | 80/100 [00:26<00:06,  3.33it/s]get samples for each class:  81%|████████  | 81/100 [00:26<00:05,  3.64it/s]get samples for each class:  82%|████████▏ | 82/100 [00:27<00:05,  3.45it/s]get samples for each class:  83%|████████▎ | 83/100 [00:27<00:05,  3.24it/s]get samples for each class:  84%|████████▍ | 84/100 [00:27<00:05,  3.07it/s]get samples for each class:  85%|████████▌ | 85/100 [00:28<00:05,  2.96it/s]get samples for each class:  86%|████████▌ | 86/100 [00:28<00:04,  2.93it/s]get samples for each class:  87%|████████▋ | 87/100 [00:28<00:04,  2.96it/s]get samples for each class:  88%|████████▊ | 88/100 [00:29<00:03,  3.02it/s]get samples for each class:  89%|████████▉ | 89/100 [00:29<00:03,  3.05it/s]get samples for each class:  90%|█████████ | 90/100 [00:29<00:03,  3.12it/s]get samples for each class:  91%|█████████ | 91/100 [00:30<00:02,  3.09it/s]get samples for each class:  92%|█████████▏| 92/100 [00:30<00:02,  3.16it/s]get samples for each class:  93%|█████████▎| 93/100 [00:30<00:02,  2.88it/s]get samples for each class:  94%|█████████▍| 94/100 [00:31<00:02,  2.96it/s]get samples for each class:  95%|█████████▌| 95/100 [00:31<00:01,  3.18it/s]get samples for each class:  96%|█████████▌| 96/100 [00:31<00:01,  3.24it/s]get samples for each class:  97%|█████████▋| 97/100 [00:32<00:00,  3.05it/s]get samples for each class:  98%|█████████▊| 98/100 [00:32<00:00,  3.05it/s]get samples for each class:  99%|█████████▉| 99/100 [00:32<00:00,  3.10it/s]get samples for each class: 100%|██████████| 100/100 [00:33<00:00,  2.86it/s]get samples for each class: 100%|██████████| 100/100 [00:33<00:00,  3.01it/s]
Support set size: 1000, Sample pool size: 10000
Preprocess Supporting set...:   0%|          | 0/1000 [00:00<?, ?it/s]Preprocess Supporting set...: 100%|██████████| 1000/1000 [00:00<00:00, 435862.41it/s]
Get the value of every sample in support set
Using sample pool to update the support set:   0%|          | 0/10000 [00:00<?, ?it/s]Using sample pool to update the support set:   4%|▍         | 387/10000 [00:00<00:02, 3866.80it/s]Using sample pool to update the support set:   9%|▊         | 863/10000 [00:00<00:02, 4390.08it/s]Using sample pool to update the support set:  13%|█▎        | 1333/10000 [00:00<00:01, 4530.13it/s]Using sample pool to update the support set:  18%|█▊        | 1787/10000 [00:00<00:01, 4528.95it/s]Using sample pool to update the support set:  22%|██▏       | 2240/10000 [00:00<00:01, 4501.37it/s]Using sample pool to update the support set:  27%|██▋       | 2693/10000 [00:00<00:01, 4508.93it/s]Using sample pool to update the support set:  31%|███▏      | 3144/10000 [00:00<00:01, 4476.73it/s]Using sample pool to update the support set:  36%|███▌      | 3592/10000 [00:00<00:01, 4436.08it/s]Using sample pool to update the support set:  40%|████      | 4036/10000 [00:00<00:01, 4367.02it/s]Using sample pool to update the support set:  45%|████▍     | 4473/10000 [00:01<00:01, 4314.47it/s]Using sample pool to update the support set:  49%|████▉     | 4905/10000 [00:01<00:01, 4249.30it/s]Using sample pool to update the support set:  53%|█████▎    | 5331/10000 [00:01<00:01, 4210.95it/s]Using sample pool to update the support set:  58%|█████▊    | 5753/10000 [00:01<00:01, 4162.65it/s]Using sample pool to update the support set:  62%|██████▏   | 6170/10000 [00:01<00:00, 4104.69it/s]Using sample pool to update the support set:  66%|██████▌   | 6581/10000 [00:01<00:00, 4037.63it/s]Using sample pool to update the support set:  70%|██████▉   | 6985/10000 [00:01<00:00, 3977.60it/s]Using sample pool to update the support set:  74%|███████▍  | 7383/10000 [00:01<00:00, 3929.27it/s]Using sample pool to update the support set:  78%|███████▊  | 7777/10000 [00:01<00:00, 3895.32it/s]Using sample pool to update the support set:  82%|████████▏ | 8167/10000 [00:01<00:00, 3847.50it/s]Using sample pool to update the support set:  86%|████████▌ | 8552/10000 [00:02<00:00, 3807.61it/s]Using sample pool to update the support set:  89%|████████▉ | 8933/10000 [00:02<00:00, 3771.31it/s]Using sample pool to update the support set:  93%|█████████▎| 9312/10000 [00:02<00:00, 3776.08it/s]Using sample pool to update the support set:  97%|█████████▋| 9692/10000 [00:02<00:00, 3781.85it/s]Successfully update the support set with sample pool, now support set size: 1000
Inference using the latest supporting set...

Inference ImageNet...:   0%|          | 0/5000 [00:00<?, ?it/s][A
Inference ImageNet...:   0%|          | 1/5000 [00:02<3:02:16,  2.19s/it][A
Inference ImageNet...:   0%|          | 2/5000 [00:03<1:56:19,  1.40s/it][A
Inference ImageNet...:   0%|          | 3/5000 [00:04<1:41:26,  1.22s/it][A
Inference ImageNet...:   0%|          | 4/5000 [00:04<1:19:50,  1.04it/s][A
Inference ImageNet...:   0%|          | 5/5000 [00:05<1:27:19,  1.05s/it][A
Inference ImageNet...:   0%|          | 6/5000 [00:07<1:31:51,  1.10s/it][A
Inference ImageNet...:   0%|          | 7/5000 [00:07<1:23:05,  1.00it/s][A
Inference ImageNet...:   0%|          | 8/5000 [00:08<1:20:36,  1.03it/s][A