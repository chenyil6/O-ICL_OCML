nohup: ignoring input
2024-10-27 15:58:16,195 - INFO - Loading pretrained ViT-L-14 from OpenAI.
You are using config.init_device='cpu', but you can also use config.init_device="meta" with Composer + FSDP for fast initialization.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.94s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:13<00:00,  4.30s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:13<00:00,  4.49s/it]
Flamingo model initialized with 0 trainable parameters
load clip successfully...
Loaded class indices from ./imagenet_class_indices.pkl
self.args.catergory_num:100
len of self.all_class_names:100
get memory bank and sample pool ...
Support set size: 1000, Sample pool size: 5000
Preprocess Supporting set...:   0%|          | 0/1000 [00:00<?, ?it/s]Preprocess Supporting set...: 100%|██████████| 1000/1000 [00:00<00:00, 480007.32it/s]
Get the value of every sample in support set
Using sample pool to update the support set:   0%|          | 0/5000 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/data/chy/online/ImageNet/main.py", line 96, in <module>
    results, predictions = inferencer.run()
  File "/data/chy/online/ImageNet/inferencers.py", line 545, in run
    self.retriever.update_online(sample)
  File "/data/chy/online/ImageNet/retriever.py", line 187, in update_online
    self.update_based_on_imbalanced(query_sample)
  File "/data/chy/online/ImageNet/retriever.py", line 351, in update_based_on_imbalanced
    sample_list = self.label2sample[target_sample.label]
KeyError: 'European green lizard'
Using sample pool to update the support set:   0%|          | 1/5000 [00:00<39:53,  2.09it/s]
